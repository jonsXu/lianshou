{"version":3,"sources":["../../../src/view/game/index.js"],"names":["name","data","isIngImg","noIngImg","width","cellWidth","matrix","Array","ctx","nowBlock","newFlag","defr","allWindow","timer","imgs","speed","score","againRest","stop","speedflag","computed","methods","createBlock","str","parseInt","Math","random","self","block","Object","type","XandY","x","y","setBlockToMatRix","number","forEach","obj","index","setMatRix","i","j","$set","init","draw","$refs","getContext","setCtx","getAttribute","loadImgs","drawImage","run","moveBlock","reflahCavs","col","length","oimg","console","info","setInterval","dropStop","fun","l","h","img","imgObject","Image","src","onload","push","judgeStop","flag","judgeRightOrLeft","moveLeft","moveRight","changeSpeed","key","document","onkeydown","event","keyCode","rotate","onkeyup","rotateChange","c","m","slice","getScore","splice","newRow","gameOver","clearInterval","stopOrContinue","mounted","beforeDestroy","watch","handler"],"mappings":"sLAAA,4B;AACe;AACbA,QAAM,MADO;AAEbC,MAFa,kBAEL;AACN,WAAO;AACLC,gBAAS,0BADJ;AAELC,gBAAS,0BAFJ;AAGLC,aAAM,CAHD,EAGG;AACRC,iBAAU,CAJL,EAIO;AACZC,cAAQ,CAAC,IAAIC,KAAJ,CAAU,EAAV,CAAD,EAAe,IAAIA,KAAJ,CAAU,EAAV,CAAf,EAA6B,IAAIA,KAAJ,CAAU,EAAV,CAA7B,EAA2C,IAAIA,KAAJ,CAAU,EAAV,CAA3C,EAAyD,IAAIA,KAAJ,CAAU,EAAV,CAAzD,EAAuE,IAAIA,KAAJ,CAAU,EAAV,CAAvE,EAAqF,IAAIA,KAAJ,CAAU,EAAV,CAArF,EAAmG,IAAIA,KAAJ,CAAU,EAAV,CAAnG,EAAiH,IAAIA,KAAJ,CAAU,EAAV,CAAjH,EAA+H,IAAIA,KAAJ,CAAU,EAAV,CAA/H,EAA6I,IAAIA,KAAJ,CAAU,EAAV,CAA7I,EAA2J,IAAIA,KAAJ,CAAU,EAAV,CAA3J,EAAyK,IAAIA,KAAJ,CAAU,EAAV,CAAzK,EAAuL,IAAIA,KAAJ,CAAU,EAAV,CAAvL,EAAqM,IAAIA,KAAJ,CAAU,EAAV,CAArM,EAAmN,IAAIA,KAAJ,CAAU,EAAV,CAAnN,EAAiO,IAAIA,KAAJ,CAAU,EAAV,CAAjO,EAA+O,IAAIA,KAAJ,CAAU,EAAV,CAA/O,EAA6P,IAAIA,KAAJ,CAAU,EAAV,CAA7P,EAA2Q,IAAIA,KAAJ,CAAU,EAAV,CAA3Q,CALH;AAMLC,WAAI,IANC,EAMI;AACTC,gBAAS,IAPJ,EAOS;AACdC,eAAQ,IARH,EAQQ;;AAEbC,YAAK,CAVA,EAUE;AACPC,iBAAU;AACRC,eAAM,IADE;AAERC,cAAK,EAFG,EAEA;AACRC,eAAM,EAHE,CAGC;AAHD,OAXL,EAeH;AACFC,aAAM,CAhBD,EAgBG;AACRC,iBAAU,KAjBL,EAiBW;AAChBC,YAAK,IAlBA,EAkBK;AACVC,iBAAU,KAnBL,CAmBW;AAnBX,KAAP;AAqBD,GAxBY;AAyBbC;AACO,wBAAW;AACZ,aADY,CAAX,CADP,CAzBa;;;AA8BbC;AACK,wBAAW;AACV,UADU,CACD;AADC,GAAX,CADL;AAIE;AACAC,eALF,yBAKe;AACX,UAAIC,MAAMC,SAASC,KAAKC,MAAL,KAAc,CAAvB,IAA0B,CAApC,CADW,CAC0B;AACrC,UAAIC,OAAO,IAAX;AACA,UAAIC,QAAQ,IAAIC,MAAJ,EAAZ;AACA;AACAD,YAAME,IAAN,GAAaP,GAAb;AACA,UAAIQ,QAAQ,IAAZ;AACA,cAAOR,GAAP;AACE;AACA,aAAK,CAAL;AACEQ,kBAAQ;AACN,YAACC,GAAE,CAAH,EAAKC,GAAE,CAAP,EADM;AAEN,YAACD,GAAE,CAAH,EAAKC,GAAE,CAAP,EAFM;AAGN,YAACD,GAAE,CAAH,EAAKC,GAAE,CAAP,EAHM;AAIN,YAACD,GAAE,CAAH,EAAKC,GAAE,CAAP,EAJM,CAAR;;AAMD;AACA;AACA,aAAK,CAAL;AACCF,kBAAQ;AACN,YAACC,GAAE,CAAH,EAAKC,GAAE,CAAP,EADM;AAEN,YAACD,GAAE,CAAH,EAAKC,GAAE,CAAP,EAFM;AAGN,YAACD,GAAE,CAAH,EAAKC,GAAE,CAAP,EAHM;AAIN,YAACD,GAAE,CAAH,EAAKC,GAAE,CAAP,EAJM,CAAR;;AAMD;AACA;AACA,aAAK,CAAL;AACCF,kBAAQ;AACN,YAACC,GAAE,CAAH,EAAKC,GAAE,CAAP,EADM;AAEN,YAACD,GAAE,CAAH,EAAKC,GAAE,CAAP,EAFM;AAGN,YAACD,GAAE,CAAH,EAAKC,GAAE,CAAP,EAHM;AAIN,YAACD,GAAE,CAAH,EAAKC,GAAE,CAAP,EAJM,CAAR;;AAMD;AACA;AACA,aAAK,CAAL;AACCF,kBAAQ;AACN,YAACC,GAAE,CAAH,EAAKC,GAAE,CAAP,EADM;AAEN,YAACD,GAAE,CAAH,EAAKC,GAAE,CAAP,EAFM;AAGN,YAACD,GAAE,CAAH,EAAKC,GAAE,CAAP,EAHM;AAIN,YAACD,GAAE,CAAH,EAAKC,GAAE,CAAP,EAJM,CAAR;;AAMD;AACA;AACA,aAAK,CAAL;AACCF,kBAAQ;AACN,YAACC,GAAE,CAAH,EAAKC,GAAE,CAAP,EADM;AAEN,YAACD,GAAE,CAAH,EAAKC,GAAE,CAAP,EAFM;AAGN,YAACD,GAAE,CAAH,EAAKC,GAAE,CAAP,EAHM;AAIN,YAACD,GAAE,CAAH,EAAKC,GAAE,CAAP,EAJM,CAAR;;AAMD,gBA7CH;;AA+CAL,YAAMG,KAAN,GAAcA,KAAd,CAtDW,CAsDQ;AACnBJ,WAAKlB,QAAL,GAAgBmB,KAAhB;AACAD,WAAKO,gBAAL,CAAsB,CAAtB;AACD,KA9DH;AA+DE;AACAA,oBAhEF,4BAgEmBC,MAhEnB,EAgE0B;AACtB,UAAIR,OAAO,IAAX;AACAA,WAAKlB,QAAL,CAAcsB,KAAd,CAAoBK,OAApB,CAA4B,UAASC,GAAT,EAAaC,KAAb,EAAmB;AAC7CX,aAAKY,SAAL,CAAeF,IAAIL,CAAnB,EAAqBK,IAAIJ,CAAzB,EAA2BE,MAA3B;AACD,OAFD;AAGD,KArEH;AAsEE;AACAI,aAvEF,qBAuEYC,CAvEZ,EAuEcC,CAvEd,EAuEgBN,MAvEhB,EAuEuB;AACnB,UAAIR,OAAO,IAAX;AACA;AACA,UAAGa,KAAG,CAAN,EAAQ;AACNb,aAAKe,IAAL,CAAUf,KAAKrB,MAAL,CAAYkC,CAAZ,CAAV,EAAyBC,CAAzB,EAA2BN,MAA3B;AACD;AACF,KA7EH;AA8EE;AACAQ,QA/EF,kBA+EQ;AACJ,WAAK1B,SAAL,GAAiB,KAAjB;AACA,UAAI2B,OAAO,KAAKC,KAAL,CAAWD,IAAtB,CAFI,CAEsB;AAC1B,WAAKpC,GAAL,GAAWoC,KAAKE,UAAL,CAAgB,IAAhB,CAAX;AACA,WAAKC,MAAL,CAAY,KAAKvC,GAAjB;AACA,WAAKJ,KAAL,GAAaoB,SAASoB,KAAKI,YAAL,CAAkB,OAAlB,CAAT,CAAb,CALI,CAK8C;AAClD,WAAK3C,SAAL,GAAiB,KAAKD,KAAL,GAAa,EAA9B,CANI,CAM6B;AACjC,UAAIuB,OAAO,IAAX;AACA,WAAKsB,QAAL,CAAc,CAAC,KAAK/C,QAAN,EAAe,KAAKC,QAApB,CAAd,EAA4C,YAAU;AAClD,aAAI,IAAIqC,IAAI,CAAZ,EAAeA,IAAI,EAAnB,EAAuBA,GAAvB,EAA6B,CAAE;AAC7B,eAAK,IAAIC,IAAI,CAAb,EAAgBA,IAAI,EAApB,EAAwBA,GAAxB,EAA8B;AAC5Bd,iBAAKY,SAAL,CAAeC,CAAf,EAAiBC,CAAjB,EAAmB,CAAC,CAApB;AACE;AACFd,iBAAKnB,GAAL,CAAS0C,SAAT,CAAmBvB,KAAKf,SAAL,CAAeE,IAAf,CAAoB,CAApB,CAAnB,EAA2C2B,IAAId,KAAKtB,SAApD,EAA+DmC,IAAIb,KAAKtB,SAAxE,EAAkF,EAAlF,EAAsF,EAAtF;AACA;AACD;AACJ;AACDsB,aAAKL,WAAL;AACAK,aAAKwB,GAAL;AACD,OAXD;AAYAxB,WAAKyB,SAAL;AACD,KApGH;AAqGE;;;AAGAC,cAxGF,wBAwGc;AACV,UAAI1B,OAAO,IAAX;AACAA,WAAKrB,MAAL,CAAY8B,OAAZ,CAAoB,UAASkB,GAAT,EAAad,CAAb,EAAe;AACjC,YAAGA,KAAG,EAAN,EAAS;AACP,iBAAO,KAAP;AACD;AACD,aAAI,IAAIC,IAAE,CAAV,EAAaA,IAAEa,IAAIC,MAAnB,EAA0Bd,GAA1B,EAA8B;AAC5B,cAAIe,OAAO7B,KAAKrB,MAAL,CAAYkC,CAAZ,EAAeC,CAAf,IAAkB,CAAlB,GAAoBd,KAAKf,SAAL,CAAeE,IAAf,CAAoB,CAApB,CAApB,GAA2Ca,KAAKf,SAAL,CAAeE,IAAf,CAAoB,CAApB,CAAtD;AACAa,eAAKnB,GAAL,CAAS0C,SAAT,CAAmBM,IAAnB,EAAyBf,IAAId,KAAKtB,SAAlC,EAA6CmC,IAAIb,KAAKtB,SAAtD,EAAgE,EAAhE,EAAoE,EAApE;AACD;AACF,OARD;AASD,KAnHH;AAoHE;AACA8C,OArHF,iBAqHO;AACHM,cAAQC,IAAR,CAAa,QAAb;;AAEA,UAAI/B,OAAO,IAAX;AACA;AACAA,WAAK0B,UAAL;AACA1B,WAAKf,SAAL,CAAeC,KAAf,GAAuB8C,YAAY,YAAU;AACzChC,aAAKiC,QAAL;AACAjC,aAAK0B,UAAL;AACH,OAHsB,EAGrB,EAHqB,CAAvB;AAIA;AACD,KAhIH;AAiIA;;;;;;;AAOEJ,YAxIF,oBAwIWnC,IAxIX,EAwIgB+C,GAxIhB,EAwIoB;AAChB,UAAIlC,OAAO,IAAX;AACA,UAAImC,IAAIhD,KAAKyC,MAAb;AACA,UAAIQ,IAAI,CAAR;;AAEAjD,WAAKsB,OAAL,CAAa,UAAS4B,GAAT,EAAa1B,KAAb,EAAmB;AAC9B,YAAI2B,YAAY,IAAIC,KAAJ,EAAhB;AACAD,kBAAUE,GAAV,GAAgBH,GAAhB;AACAC,kBAAUG,MAAV,GAAmB,YAAU;AAC3BX,kBAAQC,IAAR,CAAaO,SAAb;AACAtC,eAAKf,SAAL,CAAeE,IAAf,CAAoBuD,IAApB,CAAyBJ,SAAzB;AACAF;AACAA,eAAGD,CAAH,IAAMD,KAAN;AACD,SALD;;AAOD,OAVD;AAWD,KAxJH;AAyJE;AACAS,aA1JF,qBA0JY1C,KA1JZ,EA0JkB;AACd,UAAI2C,OAAO,KAAX;AACA,UAAI5C,OAAO,IAAX;AACA,UAAImC,IAAIlC,MAAMG,KAAN,CAAYwB,MAApB;AACA,WAAI,IAAIf,IAAE,CAAV,EAAYA,IAAEsB,CAAd,EAAgBtB,GAAhB,EAAoB;AAClB,YAAIH,MAAMT,MAAMG,KAAN,CAAYS,CAAZ,CAAV;AACA,YAAGH,IAAIL,CAAJ,IAAO,EAAP,IAAWL,KAAKrB,MAAL,CAAY+B,IAAIL,CAAJ,GAAM,CAAlB,EAAqBK,IAAIJ,CAAzB,IAA4B,CAA1C,EAA4C;AAC1CsC,iBAAO,IAAP;AACA;AACD,SAHD,MAGM;AACJA,iBAAO,KAAP;AACD;AACF;AACD,aAAOA,IAAP;AACD,KAxKH;AAyKE;AACAX,YA1KF,sBA0KY;AACR,UAAIjC,OAAO,IAAX;AACA,UAAGA,KAAKhB,IAAL,IAAagB,KAAKf,SAAL,CAAeG,KAA/B,EAAsC;AACtC;AACE,YAAGY,KAAK2C,SAAL,CAAe3C,KAAKlB,QAApB,CAAH,EAAiC;AAC/BkB,eAAKO,gBAAL,CAAsB,CAAtB;AACA;AACA;AACAP,eAAKL,WAAL;AACAK,eAAKjB,OAAL,GAAe,IAAf;AACD,SAND,MAMM;AACN;AACA;;;;;;;;;;;;;;;;;;;AAmBIiB,eAAKO,gBAAL,CAAsB,CAAC,CAAvB;AACAP,eAAKlB,QAAL,CAAcsB,KAAd,CAAoBK,OAApB,CAA4B,UAASC,GAAT,EAAa;AACvCA,gBAAIL,CAAJ;AACD,WAFD;AAGAL,eAAKO,gBAAL,CAAsB,CAAtB;AACA;AACAP,eAAKjB,OAAL,GAAe,KAAf;AACD;AACDiB,aAAKhB,IAAL,GAAY,CAAZ;AACD,OAtCH,MAsCQ;AACJgB,aAAKhB,IAAL;AACD;;;AAGJ,KAvNH;AAwNE;;;;AAIA6D,oBA5NF,4BA4NmB5C,KA5NnB,EA4NyBL,GA5NzB,EA4N6B;AACzB,UAAII,OAAO,IAAX;AACA,UAAI4C,OAAO,KAAX;AACA,UAAIT,IAAIlC,MAAMG,KAAN,CAAYwB,MAApB;;AAEA,UAAGhC,OAAO,CAAV,EAAc;AACZ,aAAI,IAAIiB,IAAE,CAAV,EAAYA,IAAEsB,CAAd,EAAgBtB,GAAhB,EAAoB;AAClB,cAAIH,MAAMT,MAAMG,KAAN,CAAYS,CAAZ,CAAV;AACA,cAAGH,IAAIJ,CAAJ,IAAO,CAAP,IAAUN,KAAKrB,MAAL,CAAY+B,IAAIL,CAAhB,EAAmBK,IAAIJ,CAAJ,GAAM,CAAzB,IAA4B,CAAzC,EAA2C;AACzC;AACAsC,mBAAO,IAAP;AACA;AACD,WAJD,MAIM;AACJA,mBAAO,KAAP;AACD;AACF;AACF,OAXD,MAWM;AACJ,aAAI,IAAI/B,KAAE,CAAV,EAAYA,KAAEsB,CAAd,EAAgBtB,IAAhB,EAAoB;AAClB,cAAIH,OAAMT,MAAMG,KAAN,CAAYS,EAAZ,CAAV;AACA,cAAGH,KAAIJ,CAAJ,IAAO,EAAP,IAAWN,KAAKrB,MAAL,CAAY+B,KAAIL,CAAhB,EAAmBK,KAAIJ,CAAJ,GAAM,CAAzB,IAA4B,CAA1C,EAA4C;AAC1C;AACAsC,mBAAO,IAAP;AACA;AACD,WAJD,MAIM;AACJA,mBAAO,KAAP;AACD;AACF;AACF;AACD,aAAOA,IAAP;AACD,KAzPH;AA0PE;AACAE,YA3PF,sBA2PY;AACR,UAAI9C,OAAO,IAAX;AACA,UAAGA,KAAK6C,gBAAL,CAAsB7C,KAAKlB,QAA3B,EAAoC,CAApC,CAAH,EAA0C;AACxC,eAAO,KAAP;AACD,OAFD,MAEM;AACJkB,aAAKO,gBAAL,CAAsB,CAAC,CAAvB;AACAP,aAAKlB,QAAL,CAAcsB,KAAd,CAAoBK,OAApB,CAA4B,UAASC,GAAT,EAAa;AACvCA,cAAIJ,CAAJ;AACD,SAFD;AAGAN,aAAKO,gBAAL,CAAsB,CAAtB;AACD;AACF,KAtQH;AAuQE;AACAwC,aAxQF,uBAwQa;AACT,UAAI/C,OAAO,IAAX;AACA,UAAGA,KAAK6C,gBAAL,CAAsB7C,KAAKlB,QAA3B,EAAoC,CAApC,CAAH,EAA0C;AACxC;AACA,eAAO,KAAP;AACD,OAHD,MAGM;AACJkB,aAAKO,gBAAL,CAAsB,CAAC,CAAvB;AACA;AACA;AACAP,aAAKlB,QAAL,CAAcsB,KAAd,CAAoBK,OAApB,CAA4B,UAASC,GAAT,EAAa;AACvCA,cAAIJ,CAAJ;AACD,SAFD;AAGA;AACAN,aAAKO,gBAAL,CAAsB,CAAtB;AACA;AACA;AACD;AACF,KAzRH;AA0RE;AACAyC,eA3RF,yBA2Re;AACX,WAAKxD,SAAL,GAAiB,CAAC,KAAKA,SAAvB,CADW,CACqB;AAChC,UAAG,KAAKA,SAAR,EAAmB;AACjB,aAAKP,SAAL,CAAeG,KAAf,GAAuB,CAAvB;AACA,aAAKJ,IAAL,GAAY,CAAZ;AACD,OAHD,MAGM;AACJ,aAAKC,SAAL,CAAeG,KAAf,GAAuB,EAAvB;AACA,aAAKJ,IAAL,GAAY,CAAZ;AACD;;AAEF,KArSH;;AAuSE;;;;AAIAyC,aA3SF,qBA2SYwB,GA3SZ,EA2SgB;AACZ,UAAIjD,OAAO,IAAX;AACAkD,eAASC,SAAT,GAAqB,UAASC,KAAT,EAAe;AAClC,YAAGA,MAAMC,OAAN,IAAe,EAAlB,EAAqB;AACnB;AACArD,eAAK8C,QAAL;AACD,SAHD,MAGO,IAAGM,MAAMC,OAAN,IAAe,EAAlB,EAAsB;AAC3BrD,eAAK+C,SAAL;AACD,SAFM,MAEA,IAAGK,MAAMC,OAAN,IAAe,EAAlB,EAAsB;AAC3B;AACArD,eAAKgD,WAAL;AACD,SAHM,MAGA,IAAGI,MAAMC,OAAN,IAAe,EAAlB,EAAsB;AAC3BrD,eAAKsD,MAAL;;AAED;AACF,OAbD;AAcAJ,eAASK,OAAT,GAAmB,UAASH,KAAT,EAAgB;AACjC;AACA,YAAGA,MAAMC,OAAN,IAAe,EAAlB,EAAsB;AACpB;AACArD,eAAKgD,WAAL;AACD;AACF,OAND;AAOD,KAlUH;;AAoUC;;;;;;;;;;;AAWCQ,gBA/UF,wBA+UeC,CA/Uf,EA+UiBC,CA/UjB,EA+UmB;AACf,aAAO,EAACrD,GAAEoD,EAAEpD,CAAF,GAAIqD,EAAEpD,CAAN,GAAQmD,EAAEnD,CAAb,EAAeA,GAAEmD,EAAEnD,CAAF,GAAImD,EAAEpD,CAAN,GAAQqD,EAAErD,CAA3B,EAAP;AACD,KAjVH;AAkVE;AACAiD,UAnVF,oBAmVU;;AAEN,UAAItD,OAAM,IAAV;AACA,UAAGA,KAAKlB,QAAL,CAAcqB,IAAd,IAAqB,CAAxB,EAA4B,OAAO,KAAP,CAHtB,CAGmC;AACzC;AACA,UAAIF,QAAQ,IAAIC,MAAJ,EAAZ;AACAD,YAAME,IAAN,GAAYH,KAAKlB,QAAL,CAAcqB,IAA1B;AACAF,YAAMG,KAAN,GAAcJ,KAAKlB,QAAL,CAAcsB,KAAd,CAAoBuD,KAApB,CAA0B,CAA1B,EAA4B3D,KAAKlB,QAAL,CAAcsB,KAAd,CAAoBwB,MAAhD,CAAd;AACA,UAAIgB,OAAO,IAAX;AACA,WAAI,IAAI/B,IAAG,CAAX,EAAcA,IAAEZ,MAAMG,KAAN,CAAYwB,MAA5B,EAAmCf,GAAnC,EAAuC;AACrC,YAAGA,KAAG,CAAN,EAAQ;AACNZ,gBAAMG,KAAN,CAAYS,CAAZ,IAAiBb,KAAKwD,YAAL,CAAkBvD,MAAMG,KAAN,CAAY,CAAZ,CAAlB,EAAiCH,MAAMG,KAAN,CAAYS,CAAZ,CAAjC,CAAjB;AACA,cAAIR,IAAGJ,MAAMG,KAAN,CAAYS,CAAZ,EAAeR,CAAtB,CAAyBC,IAAEL,MAAMG,KAAN,CAAYS,CAAZ,EAAeP,CAA1C;AACA;AACA,cAAIA,IAAE,CAAF,IAAKA,IAAE,EAAP,IAAWD,IAAE,EAAb,IAAiBA,IAAE,CAApB,IAAwBL,KAAKrB,MAAL,CAAY0B,CAAZ,EAAeC,CAAf,IAAkB,CAA7C,EAA+C;AAC7CsC,mBAAM,KAAN;AACA;AACD,WAHD,MAGO;AACLA,mBAAO,IAAP;AACD;AACF;AACF;;AAED,UAAGA,IAAH,EAAQ;AACN5C,aAAKO,gBAAL,CAAsB,CAAC,CAAvB;AACAuB,gBAAQC,IAAR,CAAa/B,KAAKlB,QAAL,CAAcsB,KAA3B;AACAJ,aAAKlB,QAAL,CAAcsB,KAAd,GAAsBH,MAAMG,KAAN,CAAYuD,KAAZ,CAAkB,CAAlB,EAAoB1D,MAAMG,KAAN,CAAYwB,MAAhC,CAAtB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACAE,gBAAQC,IAAR,CAAa/B,KAAKlB,QAAL,CAAcsB,KAA3B;AACAJ,aAAKO,gBAAL,CAAsB,CAAtB;AACD;;AAEF,KAzXH;AA0XE;;;AAGAqD,YA7XF,sBA6XY;AACR,UAAI5D,OAAO,IAAX;AACA,UAAImC,IAAI,CAAR;AACAnC,WAAKrB,MAAL,CAAY8B,OAAZ,CAAoB,UAASC,GAAT,EAAcC,KAAd,EAAoB;AACtC,YAAIE,IAAI,CAAR;AACA,aAAIA,CAAJ,EAAMA,IAAEH,IAAIkB,MAAZ,GAAqB;AACnB,cAAGlB,IAAIG,CAAJ,KAAQ,CAAX,EAAa;AACX;AACD,WAFD,MAEM;AACJA;AACD;AACF;AACD,YAAGA,KAAGH,IAAIkB,MAAV,EAAkB;AAChBO;AACAnC,eAAKrB,MAAL,CAAYkF,MAAZ,CAAmBlD,KAAnB,EAAyB,CAAzB;AACA,cAAImD,SAAS,IAAIlF,KAAJ,CAAU,EAAV,CAAb;AACA,eAAI,IAAIkC,IAAI,CAAZ,EAAgBA,IAAEgD,OAAOlC,MAAzB,EAAiCd,GAAjC,EAAsC;AACpCgD,mBAAOhD,CAAP,IAAY,CAAC,CAAb;AACD;AACDd,eAAKrB,MAAL,CAAYkF,MAAZ,CAAmB,CAAnB,EAAqB,CAArB,EAAuBC,MAAvB;AACD;AACF,OAlBD;AAmBA,cAAO3B,CAAP;AACE,aAAK,CAAL;AACCnC,eAAKX,KAAL,IAAc,GAAd;AACA;AACD,aAAK,CAAL;AACCW,eAAKX,KAAL,IAAc,GAAd;AACA;AACD,aAAK,CAAL;AACCW,eAAKX,KAAL,IAAc,GAAd;AACA;AACD,aAAK,CAAL;AACCW,eAAKX,KAAL,IAAc,GAAd;AACA,gBAZH;;AAcD,KAjaH;AAkaE;AACA0E,YAnaF,sBAmaY;AACR,UAAIrD,MAAO,KAAK/B,MAAL,CAAY,CAAZ,CAAX;AACA,UAAIiE,OAAO,KAAX;AACA,WAAI,IAAI/B,IAAE,CAAV,EAAaA,IAAEH,IAAIkB,MAAnB,EAA2Bf,GAA3B,EAAgC;AAC9B,YAAGH,IAAIG,CAAJ,KAAQ,CAAX,EAAa;AACX+B,iBAAO,IAAP;AACA;AACD,SAHD,MAGM;AACJA,iBAAO,KAAP;AACD;AACF;AACD,UAAGA,IAAH,EAAS;AACPoB,sBAAc,KAAK/E,SAAL,CAAeC,KAA7B;AACA,aAAKI,SAAL,GAAiB,IAAjB;AACD;AACF,KAlbH;AAmbE;AACA2E,kBApbF,4BAobkB;AACd,WAAK1E,IAAL,GAAY,CAAC,KAAKA,IAAlB;AACA,UAAG,KAAKA,IAAR,EAAa;AACX,aAAKiC,GAAL;AACD,OAFD,MAEK;AACHwC,sBAAc,KAAK/E,SAAL,CAAeC,KAA7B;AACD;AACF,KA3bH,GA9Ba;;AA2dbgF,SA3da,qBA2dJ;AACP;AACA,SAAKlD,IAAL;;AAEA;AACD,GAheY;AAiebmD,eAjea,2BAieE;AACbH,kBAAc,KAAK/E,SAAL,CAAeC,KAA7B;AACD,GAneY;AAoebkF,SAAM;AACJzF,YAAO;AACL0F,eAAS,mBAAY;AACnB;AACAvC,gBAAQC,IAAR,CAAa,GAAb;AACA,YAAI/B,OAAO,IAAX;AACAA,aAAK4D,QAAL;AACA5D,aAAK+D,QAAL;AACF;AACC,OARI,EADH,EApeO,E","file":"index.js","sourcesContent":["import { mapGetters, mapActions } from 'vuex'\r\nexport default {\r\n  name: 'game',\r\n  data () {\r\n    return {\r\n      isIngImg:'../../../static/cell.png',\r\n      noIngImg:'../../../static/null.png',\r\n      width:0,//画布的宽\r\n      cellWidth:0,//单元块的边长\r\n      matrix: [new Array(12),new Array(12),new Array(12),new Array(12),new Array(12),new Array(12),new Array(12),new Array(12),new Array(12),new Array(12),new Array(12),new Array(12),new Array(12),new Array(12),new Array(12),new Array(12),new Array(12),new Array(12),new Array(12),new Array(12),],\r\n      ctx:null,//画布对象\r\n      nowBlock:null,//当前正在下落的方块\r\n      newFlag:true,//是否新生成一个方块，ps：好像没怎么用到，感觉没什么作用\r\n      \r\n      defr:0,//下落延迟  ,\r\n      allWindow:{\r\n        timer:null,\r\n        imgs:[],//加载好的图片\r\n        speed:25,//速度级数\r\n      },//全局对象\r\n      score:0,//得分,\r\n      againRest:false,//重新开始\r\n      stop:true,//播放 暂停控制\r\n      speedflag:false,//是否加速\r\n    }\r\n  },\r\n  computed: {\r\n      ...mapGetters([\r\n        'ctxGetter',\r\n      ])\r\n  },\r\n  methods:{\r\n    ...mapActions([\r\n        'setCtx' // 映射 this.increment() 为 this.$store.dispatch('increment')\r\n    ]),\r\n    //创建一个block对象\r\n    createBlock(){\r\n      let str = parseInt(Math.random()*5)+1//生成随机的方块模型\r\n      let self = this \r\n      var block = new Object()\r\n      //默认第一个方块的坐标就是x=0 y=6\r\n      block.type = str\r\n      let XandY = null\r\n      switch(str){\r\n        //z型\r\n        case 1 :\r\n          XandY = [\r\n            {x:0,y:5},\r\n            {x:1,y:5},\r\n            {x:1,y:6},\r\n            {x:2,y:6}\r\n          ]\r\n         break;\r\n         //l型\r\n         case 2 :\r\n          XandY = [\r\n            {x:0,y:5},\r\n            {x:1,y:5},\r\n            {x:2,y:5},\r\n            {x:3,y:5}\r\n          ]\r\n         break;\r\n         //T 型\r\n         case 3 :\r\n          XandY = [\r\n            {x:0,y:5},\r\n            {x:1,y:4},\r\n            {x:1,y:5},\r\n            {x:1,y:6}\r\n          ]\r\n         break;\r\n         //L型\r\n         case 4 :\r\n          XandY = [\r\n            {x:0,y:5},\r\n            {x:0,y:6},\r\n            {x:1,y:6},\r\n            {x:2,y:6}\r\n          ]\r\n         break;\r\n         //田型\r\n         case 5 :\r\n          XandY = [\r\n            {x:0,y:5},\r\n            {x:0,y:6},\r\n            {x:1,y:5},\r\n            {x:1,y:6}\r\n          ]\r\n         break;\r\n      }\r\n      block.XandY = XandY//初始坐标位置\r\n      self.nowBlock = block\r\n      self.setBlockToMatRix(0)\r\n    },\r\n    //将方块在画布的值设置好\r\n    setBlockToMatRix(number){\r\n      let self = this \r\n      self.nowBlock.XandY.forEach(function(obj,index){\r\n        self.setMatRix(obj.x,obj.y,number)\r\n      })\r\n    },\r\n    //更新值\r\n    setMatRix(i,j,number){\r\n      let self = this\r\n      //self.matrix[i][j] = number;\r\n      if(i>=0){\r\n        self.$set(self.matrix[i],j,number)\r\n      }\r\n    },\r\n    //初始化画布\r\n    init(){\r\n      this.againRest = false\r\n      let draw = this.$refs.draw//画布\r\n      this.ctx = draw.getContext('2d')\r\n      this.setCtx(this.ctx)\r\n      this.width = parseInt(draw.getAttribute('width')) // 画布的宽\r\n      this.cellWidth = this.width / 12 // 单元块的边长\r\n      let self = this \r\n      this.loadImgs([this.isIngImg,this.noIngImg],function(){\r\n          for(var i = 0; i < 20; i ++) { // 初始化矩阵数组\r\n            for (var j = 0; j < 12; j ++) {\r\n              self.setMatRix(i,j,-1);\r\n                //ctx.fillRect(j * this.cellWidth,i * this.cellWidth,150,75);\r\n              self.ctx.drawImage(self.allWindow.imgs[1], j * self.cellWidth, i * self.cellWidth,20, 20);\r\n              // ctx.drawImage(this.noIngImg, j * this.cellWidth, i * this.cellWidth, this.noIngImg.width, this.noIngImg.height);\r\n            }\r\n        }\r\n        self.createBlock()\r\n        self.run()\r\n      })\r\n      self.moveBlock()\r\n    },\r\n    /**\r\n     * 刷新画布，遍历每个格子。根据格子的值来画不同的图\r\n     */\r\n    reflahCavs(){\r\n      var self = this\r\n      self.matrix.forEach(function(col,i){\r\n        if(i==20){\r\n          return false\r\n        }\r\n        for(var j=0; j<col.length;j++){\r\n          var oimg = self.matrix[i][j]<0?self.allWindow.imgs[1]:self.allWindow.imgs[0];\r\n          self.ctx.drawImage(oimg, j * self.cellWidth, i * self.cellWidth,20, 20);\r\n        }\r\n      })\r\n    },\r\n    //开始游戏\r\n    run(){\r\n      console.info(\"进入到run\")\r\n\r\n      var self = this\r\n      // self.createBlock()\r\n      self.reflahCavs()\r\n      self.allWindow.timer = setInterval(function(){\r\n          self.dropStop()\r\n          self.reflahCavs()\r\n      },40)\r\n      //this.ctx.drawImage(oimg, 6* self.cellWidth, 0 * self.cellWidth, '20', '20');\r\n    },\r\n  /**\r\n   * 预加载图片\r\n   * \r\n   * imgs - 加载的图片\r\n   * sw - 屏幕的缩放比例\r\n   * fun - 图片加载完成以后的回调函数\r\n   */\r\n    loadImgs(imgs,fun){\r\n      let self = this\r\n      let l = imgs.length\r\n      let h = 0\r\n\r\n      imgs.forEach(function(img,index){\r\n        let imgObject = new Image()\r\n        imgObject.src = img;\r\n        imgObject.onload = function(){\r\n          console.info(imgObject)\r\n          self.allWindow.imgs.push(imgObject)\r\n          h++\r\n          h>=l&&fun()\r\n        }\r\n        \r\n      })\r\n    },\r\n    //判断方块是否停止下落\r\n    judgeStop(block){\r\n      let flag = false\r\n      let self = this\r\n      let l = block.XandY.length;\r\n      for(let i=0;i<l;i++){\r\n        let obj = block.XandY[i]\r\n        if(obj.x>=19||self.matrix[obj.x+1][obj.y]>0){\r\n          flag = true\r\n          break;\r\n        }else {\r\n          flag = false\r\n        }\r\n      }\r\n      return flag\r\n    },\r\n    //方块下落停止\r\n    dropStop(){\r\n      let self = this \r\n      if(self.defr == self.allWindow.speed) {\r\n      //如果到底部 或者碰到一个方块了 就重新生成方块开始移动\r\n        if(self.judgeStop(self.nowBlock)){\r\n          self.setBlockToMatRix(1)\r\n          //self.setMatRix(self.nowBlock.XandY[0].x,self.nowBlock.XandY[0].y,1)\r\n          //self.matrix[self.noWblock.XandY[0].x][self.noWblock.XandY[0].y]=1\r\n          self.createBlock()\r\n          self.newFlag = true\r\n        }else {\r\n        //否则就继续移动，移动中的方块的 值=0\r\n        /**\r\n       * 为什么给这个defr延迟，是为了让下落方块的基础时间为1秒下落一次，\r\n       * 基础速度为25，刷新时间为40ms每次。\r\n       * 定时器内执行下落方法，每40ms就执行一次下落方法，每次执行都给defr+1.\r\n       * 等到defr==速度极数 就是25，的时候  才会执行一次下落逻辑。\r\n       * 这个时候40ms*25=1000ms =1秒。\r\n       * 用40ms的刷新是为了让每次移动也能看到移动的轨迹\r\n       * \r\n          * self.allWindow.timer = setInterval(function(){\r\n            /**\r\n             * block.XandY = [{\r\n              x:6*self.cellWidth,y:0\r\n            }]\r\n            \r\n            self.dropStop()\r\n            self.reflahCavs()\r\n            \r\n        },40)\r\n       */\r\n            self.setBlockToMatRix(-1)\r\n            self.nowBlock.XandY.forEach(function(obj){\r\n              obj.x++\r\n            })\r\n            self.setBlockToMatRix(0)\r\n            //self.matrix[self.noWblock.XandY[0].x][self.noWblock.XandY[0].y]=0\r\n            self.newFlag = false\r\n          }\r\n          self.defr = 0\r\n        } else{\r\n          self.defr++\r\n        }\r\n      \r\n      \r\n    },\r\n    /**\r\n     * 判断左右移动边界值\r\n     * @param {*} str 方向 1左  2右\r\n     */\r\n    judgeRightOrLeft(block,str){\r\n      let self = this\r\n      let flag = false\r\n      let l = block.XandY.length;\r\n      \r\n      if(str == 1 ) {\r\n        for(let i=0;i<l;i++){\r\n          let obj = block.XandY[i]\r\n          if(obj.y<=0||self.matrix[obj.x][obj.y-1]>0){\r\n            //如果往左移动的时候 碰到一个实体方块，或者当前已经在最左边了，就停止移动\r\n            flag = true\r\n            break;\r\n          }else {\r\n            flag = false\r\n          }\r\n        }\r\n      }else {\r\n        for(let i=0;i<l;i++){\r\n          let obj = block.XandY[i]\r\n          if(obj.y>=11||self.matrix[obj.x][obj.y+1]>0){\r\n            //如果往右移动的时候 碰到一个实体方块，或者当前已经在最右边了，就停止移动\r\n            flag = true\r\n            break;\r\n          }else {\r\n            flag = false\r\n          }\r\n        }\r\n      }\r\n      return flag\r\n    },\r\n    //左移动\r\n    moveLeft(){\r\n      let self = this\r\n      if(self.judgeRightOrLeft(self.nowBlock,1)){\r\n        return false\r\n      } else{\r\n        self.setBlockToMatRix(-1)\r\n        self.nowBlock.XandY.forEach(function(obj){\r\n          obj.y--\r\n        })\r\n        self.setBlockToMatRix(0)\r\n      }\r\n    },\r\n    //右移动\r\n    moveRight(){\r\n      let self = this\r\n      if(self.judgeRightOrLeft(self.nowBlock,2)){\r\n        //如果往右移动的时候 碰到一个实体方块，或者当前已经在最右边了，就停止移动\r\n        return false\r\n      } else{\r\n        self.setBlockToMatRix(-1)\r\n        //self.setMatRix(self.noWblock.XandY[0].x,self.noWblock.XandY[0].y,-1)\r\n        //self.matrix[self.noWblock.XandY[0].x][self.noWblock.XandY[0].y]=-1\r\n        self.nowBlock.XandY.forEach(function(obj){\r\n          obj.y++\r\n        })\r\n        //self.noWblock.XandY[0].y++\r\n        self.setBlockToMatRix(0)\r\n        //self.setMatRix(self.noWblock.XandY[0].x,self.noWblock.XandY[0].y,0)\r\n        //self.matrix[self.noWblock.XandY[0].x][self.noWblock.XandY[0].y]=0\r\n      }\r\n    },\r\n    //恢复速度\r\n    changeSpeed(){\r\n      this.speedflag = !this.speedflag//true 加快  false恢复\r\n      if(this.speedflag) {\r\n        this.allWindow.speed = 1 \r\n        this.defr = 1\r\n      } else{\r\n        this.allWindow.speed = 25\r\n        this.defr = 0\r\n      }\r\n      \r\n    },\r\n\r\n    /**\r\n     * 按键控制移动 37左 ，39右 38上  40 下 给电脑用\r\n     * @param {*} key \r\n     */\r\n    moveBlock(key){\r\n      let self = this \r\n      document.onkeydown = function(event){\r\n        if(event.keyCode==37){\r\n          //左移动\r\n          self.moveLeft()\r\n        } else if(event.keyCode==39) {\r\n          self.moveRight()\r\n        } else if(event.keyCode==40) {\r\n          //如果当按下的键为↓的时候，就把速度等级设置为1级。把延迟设置为1这样 1 = 1，就不会延迟了  那么就直接40ms就刷新一次 下降的时间就是40ms下一格\r\n          self.changeSpeed()\r\n        } else if(event.keyCode==38) {\r\n          self.rotate()\r\n         \r\n        }\r\n      }\r\n      document.onkeyup = function(event) {\r\n        //监听按键的放开事件，\r\n        if(event.keyCode==40) {\r\n          //当放开的为↓的时候，就把值恢复到原来的样子\r\n          self.changeSpeed()\r\n        }\r\n      }\r\n    },\r\n\r\n   /**\r\n    * 旋转变化，我自己以第三个坐标为旋转中心 （顺时针），\r\n     * y1:旋转中心的y坐标,x1:旋转中心的x坐标\r\n     * y:要旋转的方块的y坐标，x:要旋转的方块的x坐标\r\n     * y(目)：旋转后的方块的y坐标，x(目):旋转过后的方块的x坐标\r\n     * \r\n     * 公式是：y(目):y1+x1-x\r\n     *        x(目):x1+y-y1\r\n    * @param {*} c旋转中心方块 \r\n    * @param {*} m需要旋转的方块\r\n    */\r\n    rotateChange(c,m){\r\n      return {x:c.x+m.y-c.y,y:c.y+c.x-m.x}\r\n    },\r\n    //旋转，选取第三个方块为旋转中心顺时针旋转\r\n    rotate(){\r\n      \r\n      let self= this\r\n      if(self.nowBlock.type ==5)  return false //田字不变型\r\n      //旋转前要判断是否可以旋转，就是判断边界值\r\n      let block = new Object()\r\n      block.type= self.nowBlock.type\r\n      block.XandY = self.nowBlock.XandY.slice(0,self.nowBlock.XandY.length)\r\n      let flag = true\r\n      for(let i =0 ;i<block.XandY.length;i++){\r\n        if(i!=2){\r\n          block.XandY[i] = self.rotateChange(block.XandY[2],block.XandY[i])\r\n          let x= block.XandY[i].x ,y=block.XandY[i].y\r\n          //旋转后的坐标 不能超过边界值,并且方块上不能存在实体方块\r\n          if((y<0||y>11||x>19||x<0)||self.matrix[x][y]>0){\r\n            flag= false\r\n            break;\r\n          } else {\r\n            flag = true\r\n          }\r\n        }\r\n      }\r\n\r\n      if(flag){  \r\n        self.setBlockToMatRix(-1)\r\n        console.info(self.nowBlock.XandY)\r\n        self.nowBlock.XandY = block.XandY.slice(0,block.XandY.length)\r\n        //self.nowBlock.XandY = \r\n        // let XandY = self.nowBlock.XandY\r\n        // self.nowBlock.XandY.forEach(function(obj,index,arrys){\r\n        //   if(index !=2){\r\n        //     arrys[index] = self.rotateChange(self.nowBlock.XandY[2],obj)\r\n        //   }\r\n        // })\r\n        console.info(self.nowBlock.XandY)\r\n        self.setBlockToMatRix(0)\r\n      }\r\n\r\n    },\r\n    /**\r\n     * 得分调用\r\n     */\r\n    getScore(){\r\n      let self = this\r\n      var l = 0\r\n      self.matrix.forEach(function(obj, index){\r\n        var i = 0\r\n        for(i;i<obj.length;) {\r\n          if(obj[i]<=0){\r\n            break;\r\n          }else {\r\n            i++\r\n          }\r\n        }\r\n        if(i==obj.length) {\r\n          l++;\r\n          self.matrix.splice(index,1)\r\n          let newRow = new Array(12);\r\n          for(let j = 0 ; j<newRow.length ;j++) {\r\n            newRow[j] = -1\r\n          }\r\n          self.matrix.splice(0,0,newRow)\r\n        }\r\n      })\r\n      switch(l){\r\n        case 1:\r\n         self.score += 100\r\n         break;\r\n        case 2:\r\n         self.score += 300\r\n         break;\r\n        case 3:\r\n         self.score += 500\r\n         break;\r\n        case 4:\r\n         self.score += 700\r\n         break;\r\n      }\r\n    },\r\n    //游戏结束\r\n    gameOver(){\r\n      let obj =  this.matrix[0]\r\n      let flag = false\r\n      for(let i=0; i<obj.length; i++) {\r\n        if(obj[i]==1){\r\n          flag = true\r\n          break;\r\n        }else {\r\n          flag = false\r\n        }\r\n      }\r\n      if(flag) {\r\n        clearInterval(this.allWindow.timer)\r\n        this.againRest = true\r\n      }\r\n    },\r\n    //暂停\r\n    stopOrContinue(){\r\n      this.stop = !this.stop\r\n      if(this.stop){\r\n        this.run()\r\n      }else{\r\n        clearInterval(this.allWindow.timer)\r\n      }\r\n    },\r\n  },\r\n  mounted(){\r\n    //this.sets(\"wangwang\")\r\n    this.init()\r\n   \r\n    //alert(\"mounted\")\r\n  },\r\n  beforeDestroy(){\r\n    clearInterval(this.allWindow.timer)\r\n  },\r\n  watch:{\r\n    matrix:{\r\n      handler: function () {\r\n        //满一行减掉\r\n        console.info(111);\r\n        let self = this\r\n        self.getScore()\r\n        self.gameOver()\r\n      ///deep: true\r\n      },\r\n    }\r\n  }\r\n}"]}